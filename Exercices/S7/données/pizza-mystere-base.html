<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        span {
            display: inline-block;
            background-color: lightgreen;
            border-radius: 1em;
            padding: 0.25em 0.5em;
            margin: 0.2em;
        }
    </style>
</head>
<body>
    <h1>Pizza Myst√®re</h1>

    <p>
        Un client entre dans votre pizzeria et vous demande une pizza.<br>
        Mais il ne sait pas ce qu'il souhaite...
    </p>

    <p>A vous de lui proposer une composition !</p>

    <h2>Garnitures</h2>
    <p id="garnitures"></p> <!-- NOTE: Commencer avec quelques spans html pour faire les styles -->

    <h2>Recette</h2>
    <p id="recette">...</p>

    <button>Proposer la pizza</button>

    <p id="reponse"></p>

    <script>

        //// Initialisation ///////////////////////////////////////////////////
        //  1. Initialiser les donn√©es (garnitures)
        //  2. Initialiser les variables
        //  3. Initialiser les r√©f√©rences (constantes) aux √©l√©ments HTML

        // Tableau (Array) contenant les garnitures
        const garnitures = [
            'Jambon',
            'Champignons',
            'Oignons',
            'Poivrons',
            'Chorizo',
            'Olives',
            'Saumon',
        ];

        // D√©clarer un tableau vide qui contiendra notre recette
        let recette = [];

        // D√©clarer un tableau vide qui contiendra la recette myst√®re
        let recetteMyst√®re = [];

        // R√©cup√©rer les r√©f√©rences aux √©l√©ments HTML que nous allons utiliser
        const pGarnitures = document.querySelector('#garnitures');
        const pRecette = document.querySelector('#recette');
        const boutonProposer = document.querySelector('button');
        const pR√©ponse = document.querySelector('#reponse');


        //// Mise en place ////////////////////////////////////////////////////
        //  1. Afficher les garnitures sous forme de boutons cliquables
        //      Pour chaque garniture:
        //          1.1 Cr√©er un √©l√©ment nomm√© d'apr√®s la garniture
        //          1.2 Ajouter un √©v√©nement de clic
        //  2. Cr√©er la recette de la pizza myst√®re
        //  3. Ajouter un √©v√©nement de clic sur le bouton "Proposer"

        // Fonction permettant d'afficher les garnitures en tant que spans cliquables
        function afficherLesGarnitures() {
            // Pour chaque garniture,
            garnitures.forEach((garniture) => {
                // cr√©er un span,
                let span = document.createElement('span');

                // le remplir,
                span.innerText = garniture;

                // et l'ajouter au <p> correspondant.
                pGarnitures.appendChild(span);

                // Ajouter un √©v√©nement de clic tant qu'on y est
                span.addEventListener('click', choisirGarniture)
            });
        }

        // Fonction cr√©ant une recette myst√®re
        //   Le but est de s√©lectionner 3 garnitures au hasard et
        //   de stocker cette solution dans le tableau recetteMyst√®re
        function cr√©erPizzaMyst√®re() {
            // M√©langer les garnitures avec .sort() qui renvoie une copie m√©lang√©e
            const garnituresM√©lang√©es = garnitures.sort(() => 0.5 - Math.random());

            // Isoler les 3 premi√®res garnitures m√©lang√©es
            recetteMyst√®re = garnituresM√©lang√©es.slice(0, 3);

            // Tricher: Montrer la pizza myst√®re dans la console
            console.log("Pizza myst√®re:", recetteMyst√®re)
        }

        // Afficher les garnitures disponibles sous forme de boutons cliquables
        afficherLesGarnitures();

        // Cr√©er la recette de la pizza myst√®re
        cr√©erPizzaMyst√®re();

        // Ajouter un √©v√©nement de clic sur le bouton "Proposer la pizza"
        boutonProposer.addEventListener('click', proposerPizza)


        //// Phase interactive ////////////////////////////////////////////////
        //  Ces fonctions seront appel√©es par les √©v√©nements de clic d√©finis
        //  plus haut dans le code avec .addEventListener()
        //  1. Cr√©er une fonction permettant de r√©pondre au clic sur une
        //     garniture et la choisir pour la recette √† proposer
        //  2. Cr√©er une fonction permettant de r√©pondre au clic sur le
        //     bouton "Proposer la pizza"

        // Fonction g√©rant le clic sur une garniture
        function choisirGarniture() {
            // R√©cup√©rer le nom de la garniture
            const garniture = this.innerText;

            // Observer dans la console
            console.log("Ajout√©:", garniture);

            // Ajouter cette garniture √† notre recette
            recette.push(garniture);

            // Ajouter la garniture au paragraphe de la recette
            pRecette.innerText = recette.join(', ');
        }

        // Fonction g√©rant le clic sur le bouton "Proposer la pizza"
        function proposerPizza() {
            console.log("Notre proposition:", recette)

            let r√©ponse;

            // Tester si on a assez de garnitures
            // Si pas assez, r√©ponse n√©gative
            if (recette.length < recetteMyst√®re.length) {
                r√©ponse = 'üòï C\'est un peu l√©ger...';
            }

            // Si trop, r√©ponse n√©gative
            else if (recette.length > recetteMyst√®re.length) {
                r√©ponse = 'üòí Il y a trop de choses...';
            }

            // Pour chaque garniture choisie,
            else {
                recette.forEach((garniture) => {
                    // Tester si elle fait partie de la recette myst√®re
                    if (! recetteMyst√®re.includes(garniture)) {
                        // Si non, r√©ponse n√©gative
                        r√©ponse = 'üò© Il y a quelque chose que je n\'aime pas...';
                    }
                });
            }

            // Si pas de r√©ponse jusqu'ici, c'est gagn√© !
            if (r√©ponse == undefined) {
                r√©ponse = 'üòã Oui, merci !';
            }

            // Afficher la r√©ponse
            pR√©ponse.innerText += `${recette.join(', ')} ? ${r√©ponse} \n`;

            // Remise √† z√©ro de notre recette
            recette = [];
            pRecette.innerText = '...';
        }

    </script>
</body>
</html>